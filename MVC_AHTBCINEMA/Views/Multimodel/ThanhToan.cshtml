@model MVC_AHTBCINEMA.Model.Multimodel
@{
    ViewData["Title"] = "ThanhToan";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif
    }

    .container {
        margin: 30px auto;
    }

        .container .card {
            width: 100%;
            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
            background: #fff;
            border-radius: 0px;
        }

    body {
        background: #eee
    }



    .btn.btn-primary {
        background-color: #ddd;
        color: black;
        box-shadow: none;
        border: none;
        font-size: 20px;
        width: 100%;
        height: 100%;
    }

        .btn.btn-primary:focus {
            box-shadow: none;
        }

    .container .card .img-box {
        width: 80px;
        height: 50px;
    }

    .container .card img {
        width: 100%;
        object-fit: fill;
    }

    .container .card .number {
        font-size: 24px;
    }

    .container .card-body .btn.btn-primary .fab.fa-cc-paypal {
        font-size: 32px;
        color: #3333f7;
    }

    .fab.fa-cc-amex {
        color: #1c6acf;
        font-size: 32px;
    }

    .fab.fa-cc-mastercard {
        font-size: 32px;
        color: red;
    }

    .fab.fa-cc-discover {
        font-size: 32px;
        color: orange;
    }

    .c-green {
        color: green;
    }

    .box {
        height: 2000px;
        width: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #ddd;
    }

    .btn.btn-primary.payment {
        background-color: #1c6acf;
        color: white;
        border-radius: 0px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 24px;
    }


    .form__div {
        height: 50px;
        position: relative;
        margin-bottom: 24px;
    }

    .form-control {
        width: 100%;
        height: 45px;
        font-size: 14px;
        border: 1px solid #DADCE0;
        border-radius: 0;
        outline: none;
        padding: 2px;
        background: none;
        z-index: 1;
        box-shadow: none;
    }

    .form__label {
        position: absolute;
        left: 16px;
        top: 10px;
        background-color: #fff;
        color: #80868B;
        font-size: 16px;
        transition: .3s;
        text-transform: uppercase;
    }

    .form-control:focus + .form__label {
        top: -8px;
        left: 12px;
        color: #1A73E8;
        font-size: 12px;
        font-weight: 500;
        z-index: 10;
    }

    .form-control:not(:placeholder-shown).form-control:not(:focus) + .form__label {
        top: -8px;
        left: 12px;
        font-size: 12px;
        font-weight: 500;
        z-index: 10;
    }

    .form-control:focus {
        border: 1.5px solid #1A73E8;
        box-shadow: none;
    }

    img {
        width: 400px;
        height: 300px;
    }

    .message {
        display: none;
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ccc;
    }

    .btn:disabled {
        background-color: #ccc;
        cursor: not-allowed;
    }
</style>
<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-4 mb-lg-0 mb-3">
                <div class="card p-3">
                    <img src="/Image/qrthanhtoan.jpg" alt="">
                </div>
            </div>
            <div class="col-lg-4 mb-lg-0 mb-3">
                <div class="card p-3">
                    <img src="/Image/qrthanhtoan2.jpg" alt="">
                </div>
            </div>
            <div class="col-lg-4 mb-lg-0 mb-3">
                <div class="card p-3">
                    <img src="/Image/qrthanhtoan3.jpg" alt="">
                </div>
            </div>
            <div class="col-12 mt-4">
                <div class="card p-3">
                    <p class="mb-0 fw-bold h4">Phương thức thanh toán</p>
                </div>
            </div>
            <div class="col-12">
                <div class="card p-3">
                    <div class="card-body border p-0">
                        <p>

                        </p>
                        <div class="collapse show p-3 pt-0" id="collapseExample">
                            <div class="row">
                                <div class="col-lg-5 mb-lg-0 mb-3">
                                    <p class="h4 mb-0">Thông tin</p>
                                   
                               
                                     @foreach (var caChieu in Model.CaChieu)
                                    {
                                        <p class="mb-0">
                                            <span class="fw-bold">Tên phim:</span>
                                            <span class="c-green">@caChieu.Phims.TenPhim </span>
                                        </p>
                                        <p class="mb-0">
                                            <span class="fw-bold">Ngày chiếu:</span>
                                            <span class="c-green">@caChieu.NgayChieu</span>
                                        </p>
                                    }
                                     @foreach (var ve in Model.Ve)
                                    {
                                        <p class="mb-0">
                                            <span class="fw-bold">Giá:</span>
                                            <span class="c-green">@ve.GiaVe.ToString("N0") VNĐ</span>
                                        </p>
                                    }
                                </div>
                                <div class="col-lg-7">
                                    <form action="" class="form">
                                        <div class="row">
                                            <div class="col-12">
                                                <div class="btn btn-primary w-100" id="payBtn">Tạo mã giao dịch</div>
                                            </div>
                                            <div id="message" class="message"></div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    // Biến cờ để theo dõi xem mã giao dịch đã được tạo hay chưa
    var transactionCreated = false;

    document.getElementById('payBtn').addEventListener('click', function () {
        // Kiểm tra nếu mã giao dịch đã được tạo
        if (transactionCreated) {
            alert('Mã giao dịch đã được tạo. Vui lòng kiểm tra lại.');
            return;
        }

        // Hiển thị thông báo đợi duyệt
        var messageDiv = document.getElementById('message');
        messageDiv.style.display = 'block';
        messageDiv.innerHTML = 'Đang tạo mã giao dịch...';

        // Tạo mã giao dịch ngẫu nhiên
        var transactionId = 'GD' + Math.floor(Math.random() * 1000000);
        transactionCreated = true; // Đánh dấu mã giao dịch đã được tạo

        // Vô hiệu hóa nút "Thanh toán"
        document.getElementById('payBtn').disabled = true;

        // Cập nhật thông báo với mã giao dịch sau một thời gian ngắn
        setTimeout(function () {
            messageDiv.innerHTML = 'Tạo mã giao dịch thành công. Mã giao dịch của bạn là: ' + transactionId + '.<br>Nếu chuyển sai nội dung thanh toán hãy liên hệ chăm sóc khách hàng để được an ủi';
        }, 2000); // Thời gian chờ 2 giây (2000 milliseconds)
    });
</script>


